package exploiter.controller;

import AgameMain.AdminCommand;
import AgameMain.Command;
import AgameMain.Main;
import AgameMain.UserCommand;
import exploiter.Exploiter;
import exploiter.service.ResearchByIdService;

public class LogInController implements Controller {

	ResearchByIdService service = new ResearchByIdService();

	public void process() {
		System.out.println("↓↓로그인↓↓");
		System.out.println("id : ");
		String id = Main.sc.nextLine();

		System.out.println("pw : ");
		String password = Main.sc.nextLine();

		Exploiter exploiter = service.researchById(id);
		
		System.out.println(exploiter); // test

		if (exploiter != null && exploiter.getPassword().equals(password) && exploiter.getAdmin()==0) {
			
			Main.user = exploiter;
			System.out.printf("%s 님이 로그인 하였습니다.", Main.user.getNickname());
			
			Command command = new Command();
			int select = Integer.parseInt(Main.sc.nextLine());
			String user = "user";
			command.command.get(user).get(select).process();

			Main.userMenu();
			
		} else if(exploiter != null && exploiter.getPassword().equals(password) && exploiter.getAdmin()==1) {
			
			Main.user = exploiter;
			System.out.printf("관리자 %s 님이 로그인 하였습니다.", Main.user.getNickname());
			
			Command command = new Command();
			int select = Integer.parseInt(Main.sc.nextLine());
			String user = "admin";
			command.command.get(user).get(select).process();
			
			Main.adminMenu();
			
		}
		
		else {
			System.out.println("로그인 실패");
		}

	}
}